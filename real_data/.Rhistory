if (exists("var", inherits = TRUE) && !is.function(var)) rm("var", inherits = TRUE)
var <- stats::var
# Retrieve bulk and single-cell references
# Bulk = cometh lot1 (PaCL2)
ref_rna_bulk = readRDS("tcga_pdac_mediation/data/cometh_lot1/transcriptome/T_raw.rds")
# Load TCGA PDAC data
data_meth = readRDS("tcga_pdac_mediation/data/TCGA_PAAD/study_TCGA-PAAD_meth.rds")
raw_exp = read.delim("~/projects/datashare/TCGA_PAAD/clinical.cohort.2025-03-06/exposure.tsv")
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv, header = TRUE)
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv, header = TRUE")
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv, header = TRUE")
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv, header = TRUE")
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv", header = TRUE)
idx_to_keep = meta$Tumor.Sample.ID[which(meta$Tumor.Sample.ID %in% colnames(data_trans$data))]
dat_meth = data_meth$data[, idx_to_keep]
dat_trans = data_trans$data[, idx_to_keep]
data_trans = readRDS("~/projects/datashare/TCGA_PAAD/study_TCGA-PAAD_trscr.rds")
idx_to_keep = meta$Tumor.Sample.ID[which(meta$Tumor.Sample.ID %in% colnames(data_trans$data))]
dat_meth = data_meth$data[, idx_to_keep]
data_meth = readRDS("~/projects/datashare/TCGA_PAAD/study_TCGA-PAAD_meth.rds")
idx_to_keep = meta$Tumor.Sample.ID[which(meta$Tumor.Sample.ID %in% colnames(data_trans$data))]
dat_meth = data_meth$data[, idx_to_keep]
dat_trans = data_trans$data[, idx_to_keep]
meta = meta[meta$Tumor.Sample.ID %in% idx_to_keep,]
dim(dat_meth)
dim(dat_trans)
rownames(raw_exp) = paste0(raw_exp$case_submitter_id, "-01A")
rownames(raw_exp)
paste0(raw_exp$case_submitter_id, "-01A")
raw_exp = raw_exp[idx_to_keep,]
rownames(raw_exp) = paste0(raw_exp$case_submitter_id, "-01A")
# Load TCGA PDAC data
data_meth = readRDS("tcga_pdac_mediation/data/TCGA_PAAD/study_TCGA-PAAD_meth.rds")
data_trans = readRDS("tcga_pdac_mediation/data/TCGA_PAAD/study_TCGA-PAAD_trscr.rds")
meta = read.csv2("tcga_pdac_mediation/data/TCGA_PAAD/PublishedSampleTable.csv",
header = TRUE)
data_meth = readRDS("~/projects/datashare/TCGA_PAAD/study_TCGA-PAAD_meth.rds")
data_trans = readRDS("~/projects/datashare/TCGA_PAAD/study_TCGA-PAAD_trscr.rds")
meta = read.csv2("~/projects/datashare/TCGA_PAAD/PublishedSampleTable.csv",
header = TRUE)
raw_exp = read.delim("~/projects/datashare/TCGA_PAAD/clinical.project-tcga-paad.2024-07-30/exposure.tsv")
idx_to_keep = meta$Tumor.Sample.ID[which(meta$Tumor.Sample.ID %in% colnames(data_trans$data))]
dat_meth = data_meth$data[, idx_to_keep]
dat_trans = data_trans$data[, idx_to_keep]
meta = meta[meta$Tumor.Sample.ID %in% idx_to_keep,]
dim(dat_meth)
dim(dat_trans)
rownames(raw_exp) = paste0(raw_exp$case_submitter_id, "-01A")
raw_exp = raw_exp[idx_to_keep,]
length(paste0(raw_exp$case_submitter_id, "-01A"))
unique(paste0(raw_exp$case_submitter_id, "-01A"))
unique(paste0(raw_exp$case_submitter_id, "-01A"))
paste0(raw_exp$case_submitter_id, "-01A")
raw_exp$case_submitter_id
raw_exp = read.delim("~/projects/datashare/TCGA_PAAD/clinical.cohort.2025-03-06/exposure.tsv")
raw_exp = read.delim("~/projects/datashare/TCGA_PAAD/clinical.cohort.2025-03-06/exposure.tsv")
idx_to_keep = meta$Tumor.Sample.ID[which(meta$Tumor.Sample.ID %in% colnames(data_trans$data))]
dat_meth = data_meth$data[, idx_to_keep]
dat_trans = data_trans$data[, idx_to_keep]
meta = meta[meta$Tumor.Sample.ID %in% idx_to_keep,]
dim(dat_meth)
dim(dat_trans)
rownames(raw_exp) = paste0(raw_exp$case_submitter_id, "-01A")
length(paste0(raw_exp$case_submitter_id, "-01A"))
unique(paste0(raw_exp$case_submitter_id, "-01A"))
lentgh(unique(paste0(raw_exp$case_submitter_id, "-01A")))
length(unique(paste0(raw_exp$case_submitter_id, "-01A")))
raw_exp2024 = read.delim("tcga_pdac_mediation/data/TCGA_PAAD/clinical.project-tcga-paad.2024-07-30/exposure.tsv")
dim(raw_exp2024)
dim(raw_exp)
colnames(raw_exp2024)
View(raw_exp2024)
raw_exp2024$tobacco_smoking_status
raw_exp2025$tobacco_smoking_status
raw_exp$tobacco_smoking_status
raw_exp = raw_exp[raw_exp$case_submitter_id %in% gsub("-01A","",meta$Tumor.Sample.ID),]
dim(raew_exp)
dim(raw_exp)
raw_exp = read.delim("~/projects/datashare/TCGA_PAAD/clinical.cohort.2025-03-06/exposure.tsv")
raw_exp = raw_exp[raw_exp$case_submitter_id %in% gsub("-01A","",meta$Tumor.Sample.ID),]
dim(raw_exp))
dim(raw_exp)
raw_exp = raw_exp[raw_exp$case_submitter_id %in% gsub("-01A","",meta$Tumor.Sample.ID),]
dim(raw_exp)
raw_exp = raw_exp[raw_exp$case_id %in% raw_exp2024$case_id,]
dim(raw_exp)
raw_exp$case_id
dim(raw_exp2024)
sum(raw_exp$case_id %in% raw_exp2024$case_id)
raw_exp$case_id == raw_exp2024$case_id
raw_exp$case_id
raw_exp2024$case_id
raw_exp2024$case_id
length(raw_exp2024$case_id)
length(raw_exp$case_id)
length(unique(raw_exp$case_id))
idx_to_keep
length(idx_to_keep)
x = paste0(raw_exp$case_submitter_id, "-01A")
x[idx_to_keep,]
x[idx_to_keep]
x
idx_to_keep
raw_exp$idx = paste0(raw_exp$case_submitter_id, "-01A")
raw_exp$idx %in% idx_to_keep
rownames(raw_exp2024) = paste0(raw_exp2024$case_submitter_id, "-01A")
rownames(raw_exp2024)
View(raw_exp)
